"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.convertSolarToLunar=convertSolarToLunar,exports.convertSolarToSexagenary=convertSolarToSexagenary,exports.convertLunarToSolar=convertLunarToSolar,exports.STEMS_MAPPING=exports.BRANCHES_MAPPING=void 0;function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}var BRANCHES_MAPPING=["tys","suu","dan","mao","thin","tyj","ngo","mui","than","dau","tuat","hoi"];exports.BRANCHES_MAPPING=BRANCHES_MAPPING;var STEMS_MAPPING=["giap","at","binh","dinh","mau","ky","canh","tan","nham","quy"];exports.STEMS_MAPPING=STEMS_MAPPING;var JULIUS_DAY_EPOCH=2299160;function computeJuliusDayFromDate(b,c,d){var e=Math.floor,f=e((14-c)/12),a=d+4800-f,g=c+12*f-3,h=b+e((153*g+2)/5)+365*a+e(a/4)-e(a/100)+e(a/400)-32045;return 2299161>h&&(h=b+e((153*g+2)/5)+365*a+e(a/4)-32083),h}function convertJuliusDayToDate(f){var g=Math.floor,h=0,i=0,j=0;f>JULIUS_DAY_EPOCH?(h=f+32044,i=g((4*h+3)/146097),j=h-g(146097*i/4)):(i=0,j=f+32082);var k=g((4*j+3)/1461),d=j-g(1461*k/4),e=g((5*d+2)/153),l=d-g((153*e+2)/5)+1,m=e+3-12*g(e/10),n=100*i+k-4800+g(e/10);return[l,m,n]}function computeNewMoonDay(a,b){var c=Math.sin,d=Math.PI,e=Math.floor,f=a/1236.85,g=f*f,h=g*f,i=d/180,j=2415020.75933+29.53058868*a+1178e-7*g-155e-9*h+33e-5*c((166.56+132.87*f-.009173*g)*i),k=359.2242+29.10535608*a-333e-7*g-347e-8*h,l=306.0253+385.81691806*a+.0107306*g+1236e-8*h,m=21.2964+390.67050646*a-.0016528*g-239e-8*h,n=(.1734-393e-6*f)*c(k*i)+.0021*c(2*i*k);n=n-.4068*c(l*i)+.0161*c(2*i*l),n-=4e-4*c(3*i*l),n=n+.0104*c(2*i*m)-.0051*c(i*(k+l)),n=n-.0074*c(i*(k-l))+4e-4*c(i*(2*m+k)),n=n-4e-4*c(i*(2*m-k))-6e-4*c(i*(2*m+l)),n=n+.001*c(i*(2*m-l))+5e-4*c(i*(2*l+k));var o=0;return o=-11>f?.001+839e-6*f+2261e-7*g-845e-8*h-81e-9*f*h:-278e-6+265e-6*f+262e-6*g,e(j+n-o+.5+b/24)}function computeSunLongitude(a,b){var c=Math.sin,d=Math.PI,e=Math.floor,f=(a-.5-b/24-2451545)/36525,g=f*f,h=d/180,i=357.5291+35999.0503*f-1559e-7*g-48e-8*f*g,j=(1.9146-.004817*f-14e-6*g)*c(h*i);j+=(.019993-101e-6*f)*c(2*h*i)+29e-5*c(3*h*i);var k=280.46645+36000.76983*f+3032e-7*g+j;return k*=h,k-=2*d*e(k/(2*d)),e(6*(k/d))}function getLunarMonth11(a,b){var c=Math.floor,d=computeJuliusDayFromDate(31,12,a)-2415021,e=c(d/29.530588853),f=computeNewMoonDay(e,b),g=computeSunLongitude(f,b);return 9<=g&&(f=computeNewMoonDay(e-1,b)),f}function computeLeapMonthOffset(a,b){var c=Math.floor((a-2415021.076998695)/29.530588853+.5),d=0,e=1,f=computeSunLongitude(computeNewMoonDay(c+e,b),b);do d=f,e+=1,f=computeSunLongitude(computeNewMoonDay(c+e,b),b);while(f!==d&&14>e);return e-1}function convertSolarToLunar(a,b,c,d,e){var f=Math.floor,g=computeJuliusDayFromDate(b,c,d),h=f((g-2415021.076998695)/29.530588853),i=computeNewMoonDay(h+1,e);i>g&&(i=computeNewMoonDay(h,e));var j=getLunarMonth11(d,e),k=j,l=0;j>=i?(l=d,j=getLunarMonth11(d-1,e)):(l=d+1,k=getLunarMonth11(d+1,e));var m=g-i+1,n=f((i-j)/29),o=!1,p=n+11;if(365<k-j){var q=computeLeapMonthOffset(j,e);n>=q&&(p=n+10,n===q&&(o=!0))}12<p&&(p-=12),11<=p&&4>n&&(l-=1);var r=f((a+1)%24/2);return[r,m,p,l,o]}function convertSolarToSexagenary(a,b,c,d,e){var f=computeJuliusDayFromDate(b,c,d),g=convertSolarToLunar(a,b,c,d,e),h=_slicedToArray(g,4),i=h[0],j=h[1],k=h[2],l=h[3],m=STEMS_MAPPING[(l+6)%10],n=BRANCHES_MAPPING[(l+8)%12],o=STEMS_MAPPING[(12*l+k+3)%10],p=BRANCHES_MAPPING[(k+1)%12],q=STEMS_MAPPING[(f+9)%10],r=BRANCHES_MAPPING[(f+1)%12],s=STEMS_MAPPING[(2*((f+9)%5)+i)%10],t=BRANCHES_MAPPING[i];return[[s,t],[q,r],[o,p],[m,n]]}function convertLunarToSolar(a,b,c,d,e){var f=Math.floor,g=0,h=0;11>b?(g=getLunarMonth11(c-1,e),h=getLunarMonth11(c,e)):(g=getLunarMonth11(c,e),h=getLunarMonth11(c+1,e));var i=f(.5+(g-2415021.076998695)/29.530588853),j=b-11;if(0>j&&(j+=12),365<h-g){var k=computeLeapMonthOffset(g,e),l=k-2;if(0>l&&(l+=12),0!==d&&b!==l)return[0,0,0];(0!==d||j>=k)&&(j+=1)}var m=computeNewMoonDay(i+j,e);return convertJuliusDayToDate(m+a-1)}